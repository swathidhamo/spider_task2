<html>
 <head>
	<title>Arrow game</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <style type="text/css">
      body{
        background: url("https://i.stack.imgur.com/p9mUO.jpg");
      }
      #start{
        background-color: #00F000;
      }

      #pause{
        background-color: #0000F0;
      }

      #stop{
        background-color: #F00000;
      }
      #canvas{
        padding-left: 120px;
        padding-top: 20px;
      }

    </style>
 </head>
 <body>
  <div class = "page-header">
    <button id = "start">Start</button>
    <button id = "pause">Pause/Resume</button>
    <button id = "stop">Stop</button>
  </div>
   <canvas id = "canvas" width = "600" height = "500"></canvas>
   
   <script type="text/javascript">
    var canvas = document.getElementById("canvas");
    var ctx = canvas.getContext("2d");
    var A = canvas.getContext("2d");
    var star = canvas.getContext("2d");
    var statObstruction = canvas.getContext("2d");
    var ballRadius = 25;
    var y = 120;
    var dy = 2;
    var arrowStart = 30;
    var arrowLength = 180;
    var spaceBarPressed = false;
    var upPressed = false;
    var downPressed = false;
    var arrowY = 250;
    var gameScore = 0;
    var status = 0;
    var gameLives = 0;
    var startGame;
    var bowLength = 75;
    var bowIncrement = 3;
    var target = new Array();
    var score = new Array();
    var circle_one = 50;
    var circle_two = 20;
    var circle_three = 10;
    var gameLivesMax = 7;
    var shotArrow
    var leadingPointY;
    var obstructionX;
    var obstructionY;
    var obstruction = new Image;
    var obstruction_1 = new Image;
    var bullseyePic= new Image;
    var obstruction_2 = new Image;
    var obstruction_3 = new Image;
    var oppX = 250;
    var revX = Math.round(Math.random()*400);
    var revY = Math.round(Math.random()*400);
    if(revX<=150||revY<=150){
      revX = Math.round(Math.random()*400);
      revY = Math.round(Math.random()*400);
    }
    
    var oppY = 250;

    bullseyePic.src = "https://pbs.twimg.com/profile_images/598218580820299776/riyOfMzy.png";
    obstruction.src = "http://pre03.deviantart.net/536b/th/pre/i/2010/301/2/6/bullseye_by_himanuts-d31pc8v.png";
    obstruction_1.src = "http://www.clker.com/cliparts/b/m/0/m/n/D/brick-wall-jail.svg";
    obstruction_2.src = "http://img.clipartall.com/warrior-helmet-clipart-1-warrior-clipart-660_660.jpg";
    obstruction_3.src = "http://www.panel2panel.com/wp-content/uploads/2014/03/animal-number-three-md.png";

    

   

    function drawTarget(){

          ctx.beginPath();
          ctx.lineWidth = 5;
          ctx.strokeStyle = "#FF0000"
          ctx.arc(480,y, ballRadius, 0, Math.PI*2);
          ctx.stroke();
          ctx.closePath();
  
          ctx.beginPath();
          ctx.lineWidth = 5;
          ctx.strokeStyle = "#00FF00"
          ctx.arc(480,y, ballRadius+25, 0, Math.PI*2);
          ctx.stroke();
          ctx.closePath();

          ctx.beginPath();
          ctx.lineWidth = 5;
          ctx.strokeStyle = "#0000FF"
          ctx.arc(480,y, ballRadius+50, 0, Math.PI*2);
          ctx.stroke();
          ctx.closePath();
  
  
     }  
    
        function movingTarget(){
      	 ctx.clearRect(0,0,600,500);
         A.clearRect(0,0,150,150);
         drawTarget();
         gameOver();
         stationaryObjects();
         drawOpposition();

         //drawAim();
         drawScoreBoard();
         drawBow();
        
         
         y += dy;
         if( y+dy > canvas.height-75 || y+dy<75 ){
           dy = -dy;
          }
         document.addEventListener("keydown",keyDownHandler,false);
         document.addEventListener("keyup",keyUpHandler,false);
    
      function keyUpHandler(e){
          if(e.keyCode== 32){
            spaceBarPressed = false;
             gameUpdate_1 = 0; gameUpdate_2 = 0;
          }
          if(e.keyCode==40){
            downPressed = false;
          }
          if(e.keyCode == 38){
            upPressed = false;
          }
        }
          
      function keyDownHandler(e){

    	    if(e.keyCode == 32){
    		    spaceBarPressed = true;
          
            arrowStart = 30;
            gameLives++;
    	     }

          if(e.keyCode==40){
            downPressed = true;
          }

          if(e.keyCode == 38){
            upPressed = true;
          }

         }       

    if(upPressed&&arrowY>100){
      arrowY += -bowIncrement;
      }

    if(downPressed&&arrowY<360){
      arrowY += bowIncrement;
      }

    if(spaceBarPressed){  
       
      status = 0;  

         //  count++;
      shotArrow = setInterval(shootArrow,1000);

        // gameLives = gameLives-1;
       }     
    /*if(arrowY<100||arrowY>360){
      bowIncrement = -bowIncrement;
    }*/
    }
 
        function drawArrow(){
          //targetHitting();
     	    ctx.beginPath();
          ctx.font = "30px Arial";
          ctx.moveTo(arrowStart,arrowY);
          ctx.lineTo(arrowStart+arrowLength,arrowY);
          ctx.stroke();
          ctx.closePath();
          if(arrowStart>=200){
          oppositionColliosion();
        }
         // leadingPointX = arrowStart+arrowLength;
          leadingPointY = arrowY;          
         /* if(arrowStart == 30 ){
          gameLives++;
          }  */
          if(arrowStart==480){
            targetHitting();
          }
         
       }


       function shootArrow(){
       drawArrow();
       arrowStart = arrowStart + arrowLength/2;
       
      }

    
    
        function drawScoreBoard(){
            A.clearRect(0,0,150,150);
            A.strokeText(gameScore,60,70);
            A.font = "10px Arial";
           // A.lineWidth = 2;
            A.beginPath();
            //A.rect(600,100,100,100);
            A.stroke();   
            A.closePath();

            A.strokeText(gameLives,40,40);
            A.font = "10px Arial";
            //A.lineWidth = 2;
            A.beginPath();
            //A.rect(600,100,100,100);
            A.stroke();   
            A.closePath();
         // console.log(gameLives);


      }

        function drawBow(){

         ctx.beginPath();
         ctx.font = "30px Arial";
         ctx.moveTo(50,arrowY);
         ctx.lineTo(125,arrowY);
         ctx.stroke();
         ctx.closePath(); 

         ctx.beginPath();
         ctx.font = "30px Arial";
         ctx.arc(50,arrowY, 75, -.5*Math.PI, -1.5*Math.PI);
         ctx.stroke();
         ctx.closePath();  

         ctx.beginPath();
         ctx.font = "30px Arial";
         ctx.moveTo(50,arrowY-bowLength);
         ctx.lineTo(50,arrowY+bowLength);
         ctx.stroke();
         ctx.closePath();  


      }

        function bullsEye(){
        
           star.beginPath();
           star.drawImage(bullseyePic,450,y-50,150,150);
           star.stroke(); 
           star.closePath();
        
      }
      function stationaryObjects(){
           obstructionX = 200;
           obstructionY = 400;
            

           statObstruction.beginPath();
           statObstruction.drawImage(obstruction,obstructionX,obstructionY,70,50);
           statObstruction.stroke(); 
           statObstruction.closePath();

           obstructionX = 150;
           obstructionY = 90;
           
           statObstruction.beginPath();
           statObstruction.drawImage(obstruction_2,obstructionX,obstructionY,70,50);
           statObstruction.stroke(); 
           statObstruction.closePath();

      }
        function drawOpposition(){

           statObstruction.beginPath();
           statObstruction.rect(oppX,oppY,70,60);
           statObstruction.drawImage(obstruction_1,oppX,oppY,70,60)
           statObstruction.stroke(); 
           statObstruction.closePath();
           
           statObstruction.beginPath();
           statObstruction.rect(revX,revY,60,50);
           statObstruction.drawImage(obstruction_3,revX,revY,60,50);
           statObstruction.stroke(); 
           statObstruction.closePath();



        }
         


        function oppositionColliosion(){
          ctx.beginPath();
          ctx.rect(oppX,oppY,70,60);
       
          if(ctx.isPointInPath(arrowStart,arrowY)){
            alert("oops");
            gameScore -= 10;
        
          }

          ctx.beginPath();
          ctx.rect(revX,revY,60,50)
          if(ctx.isPointInPath(arrowStart,arrowY)){
            alert("You have won 3 more lives!");
               gameLivesMax+=3;
            /*arrowStart = -arrowStart;
            targetHitting();*/


          }

        
              }
        
        
            
        function targetHitting() {
        
            
             //for the outermost circle
             if (  leadingPointY>y-75 && leadingPointY<y+75){

               if(leadingPointY>y-50 && leadingPointY<y+50){
                  
                  if(leadingPointY>y-25 && leadingPointY<y+25){
                    gameScore  += circle_one;
                    bullsEye();
          
                  }
                  else{
                    gameScore += circle_two;
          
                  }
               }
               else{
                    gameScore += circle_three;
              
               }

             }

            else{
              gameScore += 0;
             }
       
         }
         

        function gameOver(){
          if(gameLives==gameLivesMax){
          clearInterval(startGame);
          alert("gameOver!! You scored "+ gameScore + " points");
          }
      }


      $("#stop").click(function(){
          clearInterval(startGame);
          clearInterval(shotArrow);
          alert("You scored "+gameScore+ " points");
      });

      $("#start").click(function(){
        startGame = setInterval(movingTarget,20);
      
      });

      $("#pause").click(function(){
        clearInterval(startGame);
        clearInterval(shotArrow);      
      });

      $("#pause").dblclick(function(){
        startGame = setInterval(movingTarget,20);
        shotArrow = setInterval(shootArrow,1000);
      });

          /*  function targetHitting(){
        
    
        if( ( (arrowStart>375&&arrowStart<400) || (arrowStart>500&&arrowStart<525) )&&( (arrowY>y-75&&arrowY<y-50) || (arrowY>y+50&&arrowY<y+75) ) ){ 
             gameScore += 10;
         }

        else if( ( (arrowStart>400&&arrowStart<425) || (arrowStart>475&&arrowStart<500) ) && ( (arrowY>y-50&&arrowY<y-25) || (arrowY>y+25&&arrowY<y+50) ) ){ 
             gameScore += 25;
         }

        else if((arrowStart>425&&arrowStart<475) && (arrowY>y-25&&arrowY<y+25)){ 
             gameScore += 50;
         }
                
      }*/

   </script>
 </body>
</html>